# ğŸ“˜ Info-Master ì„¤ê³„ ë¬¸ì„œ (V3.0 â€“ ê´€ë¦¬ì ë‹¨ì¼ ëª¨ë¸)

## 1. í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” ê´€ë¦¬ì(Admin) ë‹¨ì¼ ê³„ì •ì´ ê´€ë¦¬í•˜ëŠ” ë¬¸ì œ(Question) ì¤‘ì‹¬ í•™ìŠµ/ê´€ë¦¬ ì‹œìŠ¤í…œì´ë‹¤.  

ì¼ë°˜ ì‚¬ìš©ìëŠ” ì½ê¸° ì „ìš©(ì¡°íšŒë§Œ ê°€ëŠ¥)ì´ë©°, ìƒì„±Â·ìˆ˜ì •Â·ì‚­ì œ(CUD)ëŠ” ê´€ë¦¬ìë§Œ ìˆ˜í–‰í•œë‹¤.

ê° ë¬¸ì œëŠ” í•˜ë‚˜ì˜ ë‹µì•ˆ(Answer)ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

ë³¸ ë¬¸ì„œëŠ” í˜„ì¬ êµ¬í˜„ ê¸°ì¤€ì˜ ë„ë©”ì¸ ì„¤ê³„, API êµ¬ì¡°, ì„¤ê³„ ê²°ì • ì‚¬í•­ì„ ê¸°ë¡í•œë‹¤.

## 2. í•µì‹¬ ë„ë©”ì¸ ëª¨ë¸

### 2.1 ì—”í‹°í‹° ê´€ê³„
```text
Admin (ì¸ì¦ ì£¼ì²´, ë„ë©”ì¸ê³¼ ë¶„ë¦¬)

Tag (1) â”€â”€ (N) Question (1) â”€â”€ (1) Answer
```
- Adminì€ ì¸ì¦ ì£¼ì²´ë¡œë§Œ ì¡´ì¬í•˜ë©° Question ë„ë©”ì¸ê³¼ ì§ì ‘ì ì¸ ì—°ê´€ê´€ê³„ë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤.

- Questionì€ ì½˜í…ì¸  ë„ë©”ì¸ì˜ Aggregate Rootì´ë‹¤.

- Adminì€ ì—¬ëŸ¬ Questionì„ ìƒì„±Â·ê´€ë¦¬í•œë‹¤.

- Questionì€ ìµœëŒ€ 1ê°œì˜ Answerë¥¼ ê°€ì§„ë‹¤.

- AnswerëŠ” Questionì— ì¢…ì†ëœë‹¤.

- Questionì€ í•˜ë‚˜ì˜ Tagì™€ ì—°ê²°ëœë‹¤.

- í˜„ì¬ ë‹¨ê³„ì—ì„œëŠ” Adminì€ ê³ ì • ê³„ì •(Seed Data)ìœ¼ë¡œë§Œ ì¡´ì¬í•œë‹¤.
---
## 3. ì„¤ê³„ ì›ì¹™

### 3.1 Aggregate Root

- Questionì€ Aggregate Rootì´ë‹¤.

- AnswerëŠ” Questionì˜ í•˜ìœ„ ì—”í‹°í‹°ë¡œ ì·¨ê¸‰í•œë‹¤.

- AnswerëŠ” ë…ë¦½ CRUD ëŒ€ìƒì´ ì•„ë‹ˆë‹¤.

- AnswerëŠ” Questionì„ í†µí•´ì„œë§Œ ìƒì„±Â·ìˆ˜ì •Â·ì¡°íšŒëœë‹¤.

### 3.2 Answer ì„¤ê³„ ê²°ì •

| í•­ëª©           | ê²°ì •                    |
| ------------ | --------------------- |
| Answer ë‹¨ë… ì¡°íšŒ | âŒ ì—†ìŒ                  |
| Answer ë‹¨ë… ìƒì„± | âŒ ì—†ìŒ                  |
| Answer ë‹¨ë… ìˆ˜ì • | âŒ ì—†ìŒ                  |
| Answer ë‹¨ë… ì‚­ì œ | âŒ ì—†ìŒ                  |
| Answer ìƒì„±/ìˆ˜ì • | Question í•˜ìœ„ Upsert    |
| Answer ì‚­ì œ    | Question ì‚­ì œ ì‹œ cascade |
---

## 4. API ì„¤ê³„

### 4.1 Question API
| í•­ëª©           | ê²°ì •                    |
| ------------ | --------------------- |
| Answer ìƒì„±/ìˆ˜ì • | Question í•˜ìœ„ Upsert    |
| Answer ì‚­ì œ    | Question ì‚­ì œ ì‹œ cascade |

- í˜„ì¬ ë‹¨ê³„ì—ì„œëŠ” ì¸ì¦ì„ ì ìš©í•˜ì§€ ì•Šìœ¼ë©° ê´€ë¦¬ì ì—¬ë¶€ëŠ” AdminContextë¥¼ í†µí•´ ì²˜ë¦¬í•œë‹¤.
---
### 4.2 Answer API (Question í•˜ìœ„ ë¦¬ì†ŒìŠ¤)

| ê¸°ëŠ¥                | Method | URL                          |
| ----------------- | ------ | ---------------------------- |
| ë‹µì•ˆ ìƒì„±/ìˆ˜ì • (Upsert) | PUT    | `/api/questions/{id}/answer` |

- Answer ì¡°íšŒëŠ” Question ì¡°íšŒ ì‘ë‹µì— í¬í•¨ëœë‹¤.
- Answer ì „ìš© GET APIëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 4.3 Tag API
| ê¸°ëŠ¥       | Method | URL              |
| -------- | ------ | ---------------- |
| íƒœê·¸ ìƒì„±    | POST   | `/api/tags`      |
| íƒœê·¸ ë‹¨ê±´ ì¡°íšŒ | GET    | `/api/tags/{id}` |
| íƒœê·¸ ì „ì²´ ì¡°íšŒ | GET    | `/api/tags`      |
| íƒœê·¸ ìˆ˜ì •    | PUT    | `/api/tags/{id}` |
| íƒœê·¸ ì‚­ì œ    | DELETE | `/api/tags/{id}` |

- Tag ì—­ì‹œ ê´€ë¦¬ìì— ì˜í•´ ê´€ë¦¬ë˜ë©°, ì¼ë°˜ ì‚¬ìš©ìëŠ” ì¡°íšŒë§Œ ê°€ëŠ¥í•˜ë‹¤.

## 5. ê´€ë¦¬ì(Admin) ì •ì±…

### 5.1 ê´€ë¦¬ì ëª¨ë¸

- Adminì€ DBì— ì‚¬ì „ ìƒì„±ëœë‹¤.

- ê´€ë¦¬ìëŠ” ë‹¨ì¼ ê³„ì •ìœ¼ë¡œ ìš´ì˜ëœë‹¤.

- ê´€ë¦¬ì ë¡œê·¸ì¸ì€ JWT ì¸ì¦ìœ¼ë¡œ ì²˜ë¦¬ëœë‹¤.

- ê´€ë¦¬ì ê¶Œí•œì€ URLì´ ì•„ë‹Œ ì„œë²„ í•„í„°ì—ì„œ ê²€ì¦ëœë‹¤.

- ê´€ë¦¬ì IDëŠ” ê³ ì • ê°’ìœ¼ë¡œ ê´€ë¦¬ëœë‹¤.

## 6. Controller ì„¤ê³„ ì›ì¹™
### 6.1 Controller ì±…ì„

- ControllerëŠ” ìš”ì²­ ë°ì´í„° ì „ë‹¬ë§Œ ë‹´ë‹¹í•œë‹¤.

- ì¸ì¦ ë° ê´€ë¦¬ì ì—¬ë¶€ íŒë‹¨ì€ ì„œë²„ í•„í„°ì—ì„œ ì²˜ë¦¬

- ë„ë©”ì¸ ê·œì¹™ ë° í–‰ìœ„ ê²€ì¦ì€ Service ê³„ì¸µì—ì„œ ì²˜ë¦¬
```java
PathVariable â†’ ëŒ€ìƒ ë¦¬ì†ŒìŠ¤
AdminContext â†’ í–‰ìœ„ì(ê´€ë¦¬ì)
```
### 6.2 Controller êµ¬ì¡°
```text
controller
 â”œâ”€ QuestionController
 â”‚   â”œâ”€ Question CRUD
 â”‚   â””â”€ Answer Upsert
 â””â”€ TagController
```
- AnswerControllerëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.

## 7. Service ì„¤ê³„

### 7.1 QuestionService

- Question CRUD

- ê´€ë¦¬ì ì†Œìœ  ê²€ì¦

- Question ì‚­ì œ ì‹œ Answer cascade ì‚­ì œ

### 7.2 AnswerService

- ì—­í• : Answer Upsert

- Answerê°€ ì—†ìœ¼ë©´ ìƒì„±

- Answerê°€ ìˆìœ¼ë©´ ìˆ˜ì •

- AnswerRepository ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

- í•­ìƒ Questionì„ í†µí•´ ê´€ë¦¬í•œë‹¤.

## 8.ì„¤ê³„ìƒ ì£¼ì˜ ì‚¬í•­

### 8.1 adminIdì˜ ì˜ë¯¸

- adminIdëŠ” í–‰ìœ„ì ì‹ë³„ìì´ë©°
- PathVariable idëŠ” ëŒ€ìƒ ë¦¬ì†ŒìŠ¤ì´ë‹¤.
```java
update(questionId, adminId)
```
- ê´€ë¦¬ìë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë¬¸ì œ ìˆ˜ì • ê¶Œí•œì„ ê²€ì¦í•œë‹¤.

### 8.2 Answer ì¡°íšŒ ì •ì±…

- AnswerëŠ” í•­ìƒ Question ì¡°íšŒ ì‹œ í¬í•¨ëœë‹¤.

- Answer ë‹¨ë… ì¡°íšŒ / ê²€ìƒ‰ APIëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.

## 9. ì„¤ê³„ ë³€ê²½ ì´ë ¥

- ì‚¬ìš©ì ì°¸ì—¬í˜• ëª¨ë¸ ì œê±°

- Spring Security ì„ì‹œ ì œê±°

- Admin ë‹¨ì¼ ê³ ì • ëª¨ë¸ ë„ì…

- Answer ë‹¨ë… CRUD ì œê±°

- Aggregate êµ¬ì¡° ë‹¨ìˆœí™”

- ì„¸ì…˜ + ì¿ í‚¤ -> JWT ë°©ì‹ìœ¼ë¡œ ë³€ê²½

## 10. ë³´ì•ˆ

1. POST /admin/login
2. AdminAuthServiceì—ì„œ ì¸ì¦
3. JwtTokenProvider.createToken()
4. accessToken ì‘ë‹µ
5. í”„ë¡ íŠ¸ì—ì„œ localStorage ì €ì¥
6. ì´í›„ ìš”ì²­ ì‹œ Authorization í—¤ë”ì— Bearer í† í° í¬í•¨
7. JwtAuthenticationFilterì—ì„œ ê²€ì¦
8. SecurityContextì— Authentication ì£¼ì…

## 11. í…ŒìŠ¤íŠ¸ ì „ëµ

- Question + Answer í†µí•© í…ŒìŠ¤íŠ¸ ì¤‘ì‹¬

- Answer ë‹¨ë… í…ŒìŠ¤íŠ¸ ì—†ìŒ

- Tag CRUD ë³„ë„ í…ŒìŠ¤íŠ¸

## 12. ìš´ì˜/ê°œë°œ êµ¬ì¡°
- íŒŒì¼ ë¶„ë¦¬
```text
application.yml
  â””â”€ ê³µí†µ ì„¤ì •
  â””â”€ application-secret.yml import

application-dev.yml
  â””â”€ ê°œë°œ DB ì„¤ì •

application-prod.yml
  â””â”€ ìš´ì˜ DB ì„¤ì •

SPRING_PROFILES_ACTIVE
  â””â”€ Docker / IDE ì‹¤í–‰ í™˜ê²½ì—ì„œ ì§€ì •
```
- ê°œë°œ = PC / ì„œë²„ = ë¼ì¦ˆë² ë¦¬íŒŒì´ 4
```text
[ê°œë°œ PC]
1. Maven ë¹Œë“œ (jar ìƒì„±)
2. ìš´ì˜ìš© Docker ì´ë¯¸ì§€ ìƒì„±
3. ì´ë¯¸ì§€ ì „ë‹¬ (Docker Hub or scp)

[ë¼ì¦ˆë² ë¦¬íŒŒì´]
4. ì´ë¯¸ì§€ pull ë˜ëŠ” load
5. docker-compose.prod.yml ì‹¤í–‰
```